# Story 1.1: Project Setup and Development Environment

## Status
Draft

## Story
**As a** developer,
**I want** a complete development environment with Next.js, PayloadCMS, MongoDB, and comprehensive development tooling,
**so that** I can begin building the workout app with all necessary tools, quality assurance, and infrastructure.

## Acceptance Criteria

1. **Next.js application is initialized** with TypeScript, Tailwind CSS, and ShadCN components configured
2. **PayloadCMS is integrated** and running locally with MongoDB connection and TypeScript support
3. **Docker Compose setup** provides local MongoDB instance for development
4. **Git repository is initialized** with proper .gitignore and initial commit
5. **TypeScript configuration** is properly set up with strict type checking and path aliases
6. **Code quality tools are configured** including ESLint, Prettier, and/or Biome for consistent code formatting
7. **Testing framework is set up** with Vitest for unit/integration tests and Playwright for E2E testing
8. **Pre-commit hooks are configured** using Husky to run type checks, linting, and tests before commits
9. **Development scripts are configured** for easy local development startup, testing, and building
10. **Basic project structure** follows monorepo pattern with clear separation of concerns
11. **Environment variables** are properly configured for local development with type safety
12. **Health check endpoint** is available to verify all services are running
13. **CI/CD pipeline foundation** is established for automated testing and deployment (GitHub Actions or similar)
14. **Code coverage reporting** is configured to track test coverage across the project

## Tasks / Subtasks

- [ ] **Initialize Git Repository and First Commit** (AC: 4)
  - [ ] Initialize git repository in project root
  - [ ] Create comprehensive .gitignore file for Next.js, Node.js, and development tools
  - [ ] Make initial commit with clean slate before any code generation

- [ ] **Bootstrap Next.js Application with PayloadCMS** (AC: 1, 2)
  - [ ] Run `npx create-payload-app@latest` to bootstrap the application
  - [ ] Configure PayloadCMS integration with TypeScript support
  - [ ] Set up MongoDB connection configuration
  - [ ] Verify PayloadCMS admin interface is accessible

- [ ] **Configure Development Environment** (AC: 3, 5, 11)
  - [ ] Set up Docker Compose for local MongoDB instance
  - [ ] Configure TypeScript with strict type checking and path aliases
  - [ ] Set up environment variables with type safety (.env.example, .env.local)
  - [ ] Create health check endpoint to verify all services

- [ ] **Set Up Code Quality and Testing Tools** (AC: 6, 7, 8, 14)
  - [ ] Configure ESLint with Next.js and TypeScript rules
  - [ ] Set up Prettier for code formatting
  - [ ] Configure Vitest for unit and integration testing
  - [ ] Set up Playwright for E2E testing
  - [ ] Configure Husky pre-commit hooks for type checks, linting, and tests
  - [ ] Set up code coverage reporting

- [ ] **Establish Project Structure and Scripts** (AC: 9, 10)
  - [ ] Organize project structure following unified project structure from architecture
  - [ ] Configure development scripts (dev, build, test, lint, type-check)
  - [ ] Set up build and deployment scripts
  - [ ] Create README with setup instructions

- [ ] **Set Up CI/CD Pipeline** (AC: 13)
  - [ ] Configure GitHub Actions workflow for automated testing
  - [ ] Set up automated deployment pipeline foundation
  - [ ] Configure environment-specific deployment settings

## Dev Notes

### Previous Story Insights
This is the first story in the project, so no previous story context exists.

### Technology Stack Requirements
[Source: architecture.md#tech-stack]

**Frontend Framework:** Next.js 15.5+ with TypeScript 5.3+
**UI Components:** ShadCN/ui with Tailwind CSS 4.1+
**Backend Framework:** PayloadCMS 3.53+ integrated into Next.js
**Database:** MongoDB 7.0+ with Docker Compose for local development
**State Management:** Zustand for lightweight state management
**Testing:** Vitest for unit/integration tests, Playwright for E2E testing
**Code Quality:** ESLint, Prettier, Husky pre-commit hooks

### Project Structure Requirements
[Source: architecture.md#unified-project-structure]

The project should follow this structure:
```
workout-app/
├── src/
│   ├── components/          # React components
│   │   ├── ui/             # ShadCN base components
│   │   ├── auth/           # Authentication components
│   │   ├── workout/        # Workout-specific components
│   │   ├── program/        # Program management components
│   │   └── common/         # Shared components
│   ├── app/                # Next.js App Router
│   │   ├── (auth)/         # Authentication route group
│   │   ├── (app)/          # Product user-facing pages
│   │   ├── (payload)/      # PayloadCMS route group
│   │   ├── globals.css     # Global styles
│   │   └── layout.tsx      # Root layout
│   ├── payload/            # PayloadCMS configuration
│   │   ├── collections/    # PayloadCMS collection definitions
│   │   ├── payload.config.ts
│   │   └── payload-client.ts
│   ├── actions/            # Server actions
│   ├── hooks/              # Custom React hooks
│   ├── stores/             # Zustand state stores
│   ├── types/              # TypeScript type definitions
│   └── utils/              # Utility functions
├── public/                 # Static assets
├── tests/                  # Test files
├── docs/                   # Documentation
├── .env.example            # Environment template
├── .env.local              # Local environment variables
├── .gitignore
├── middleware.ts           # Next.js middleware
├── package.json
├── next.config.js
├── tailwind.config.js
├── tsconfig.json
└── README.md
```

### PayloadCMS Integration Requirements
[Source: architecture.md#payloadcms-collections]

- PayloadCMS should be integrated directly into the Next.js application
- Use PayloadCMS Local API for all data operations
- Configure collections for: users, productUsers, programs, milestones, sessions, exercises, exerciseCompletions
- Set up progressive validation strategy allowing draft content creation
- Implement admin user vs product user separation

### Environment Configuration
[Source: architecture.md#environment-configuration]

Required environment variables:
```bash
# Frontend
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Backend
DATABASE_URI=mongodb://localhost:27017/workout-app
JWT_SECRET=your-super-secret-jwt-key
PAYLOAD_SECRET=your-payload-secret-key

# SMS Service (for future stories)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=your-twilio-phone-number

# Shared
NODE_ENV=development
```

### Docker Compose Setup
[Source: architecture.md#local-development-setup]

MongoDB should be configured with Docker Compose:
```yaml
version: '3.8'
services:
  mongodb:
    image: mongo:7.0
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_DATABASE: workout-app
    volumes:
      - mongodb_data:/data/db

volumes:
  mongodb_data:
```

### Testing Requirements
[Source: architecture.md#testing-strategy]

**Testing Framework:** Vitest for unit/integration tests, Playwright for E2E testing
**Test Organization:** 
- Frontend tests in `tests/components/`
- Backend tests in `tests/actions/`
- E2E tests in `tests/e2e/`
**Test Standards:** All server actions must be tested, components should have unit tests, critical user flows need E2E tests

### Code Quality Standards
[Source: architecture.md#coding-standards]

**File Naming:** All files MUST use kebab-case (non-negotiable)
**TypeScript:** Strict type checking enabled, all components must have TypeScript interfaces
**Error Handling:** All server actions must use proper error handling with Zod validation
**State Management:** Use Zustand for global state, never mutate state directly

### Critical Implementation Notes

1. **Git First Approach:** Initialize Git repository and make first commit BEFORE running `npx create-payload-app`
2. **PayloadCMS Bootstrap:** Use `npx create-payload-app@latest` to bootstrap the application with proper PayloadCMS integration
3. **MongoDB Setup:** Use Docker Compose for local MongoDB development
4. **TypeScript Configuration:** Enable strict mode and configure path aliases for clean imports
5. **Testing Setup:** Configure both Vitest and Playwright for comprehensive testing coverage
6. **Code Quality:** Set up ESLint, Prettier, and Husky for consistent code quality
7. **Project Structure:** Follow the unified project structure from architecture document
8. **Environment Variables:** Set up proper environment configuration with type safety

## Testing

### Testing Standards
[Source: architecture.md#testing-strategy]

**Test File Location:** All tests in `tests/` directory with appropriate subdirectories
**Testing Frameworks:** 
- Vitest for unit and integration tests
- Playwright for E2E testing
- Testing Library for React component testing

**Test Standards:**
- All server actions must have unit tests
- Components should have unit tests for critical functionality
- Critical user flows need E2E tests
- Test coverage should be tracked and reported

**Testing Patterns:**
- Use proper mocking for external services
- Test both success and error scenarios
- Include integration tests for PayloadCMS operations
- E2E tests should cover mobile-optimized workflows

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-27 | 1.0 | Initial story creation with Git-first approach and PayloadCMS bootstrap | Bob (SM) |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*Results from QA Agent review will be populated here after story completion*
